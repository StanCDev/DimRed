<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DimRed &mdash; DimRed  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DimRed" href="modules.html" />
    <link rel="prev" title="DimRed" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DimRed
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">DimRed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use-dimred">How to use DimRed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#transforming-data">Transforming Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluating-models">Evaluating models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#for-developpers">For developpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#contributing">Contributing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">DimRed</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DimRed</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">DimRed</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/readme_link.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dimred">
<h1>DimRed<a class="headerlink" href="#dimred" title="Link to this heading"></a></h1>
<p>DimRed is a dimenstionality reduction (DR) library built around sklearn. It integrates three main functionalities: data <strong>transformation</strong>, model <strong>evaluation</strong>, and data <strong>plotting</strong>.</p>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Link to this heading"></a></h2>
<p>Use the package manager <a class="reference external" href="https://pip.pypa.io/en/stable/">pip</a> to install DimRed.</p>
<p>The dependencies for this library are <a class="reference external" href="https://www.google.com/search?client=firefox-b-d&amp;amp;q=python+joblib">joblib</a>, <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a>, <a class="reference external" href="https://numpy.org/">numpy</a>, <a class="reference external" href="https://scikit-learn.org/stable/">sci-kit learn</a>, <a class="reference external" href="https://umap-learn.readthedocs.io/en/latest/">umap</a>, <a class="reference external" href="https://pypi.org/project/pacmap/">pacmap</a>, <a class="reference external" href="https://pypi.org/project/trimap/">trimap</a>, <a class="reference external" href="https://opentsne.readthedocs.io/en/stable/">open t-SNE</a>, and <a class="reference external" href="https://pandas.pydata.org/">pandas</a>.</p>
<p>To install DimRed via pip simply run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>DimRed
</pre></div>
</div>
<p>Or clone the repo, cd into it and run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>DimRed
pip<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="how-to-use-dimred">
<h2>How to use DimRed<a class="headerlink" href="#how-to-use-dimred" title="Link to this heading"></a></h2>
<p>As stated previously, DimRed is centered around 3 functionalities…</p>
<section id="transforming-data">
<h3>Transforming Data<a class="headerlink" href="#transforming-data" title="Link to this heading"></a></h3>
<p>Data transformation is undertaken using the <code class="docutils literal notranslate"><span class="pre">DimRed.transform</span></code> module. A dimensionality reduction model is instanciated using the <code class="docutils literal notranslate"><span class="pre">DimRed.transform.TransformWrapper</span></code> class. As the name of the class indicates, it is a wrapper class that takes any object satisfying the definition of a <strong>Transform</strong> (an object that must have certain methods with specific signatures).</p>
<p>There are two ways of instanciating a <code class="docutils literal notranslate"><span class="pre">TransformWrapper</span></code>object:</p>
<ol class="arabic simple">
<li><p>By specifying the <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">:</span> <span class="pre">str</span></code> parameter. This will create a built-in DR model from the libraries in the <a class="reference internal" href="#install"><span class="xref myst">install</span></a> section.</p></li>
<li><p>By passing a <code class="docutils literal notranslate"><span class="pre">base_model</span></code> parameter. Using the <code class="docutils literal notranslate"><span class="pre">base_model</span></code>argument allows for the use of a user defined DR model.</p></li>
</ol>
<p>Here is a quick example on the use of  <code class="docutils literal notranslate"><span class="pre">TransformWrapper</span></code> to transform the iris dataset to 2 dimensions with a built in DR method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.transform</span> <span class="kn">import</span> <span class="n">TransformWrapper</span>
<span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">TransformWrapper</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;PCA&quot;</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X_reduced</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;PCA reduction of iris data set to 2 dimensions&quot;</span><span class="p">,</span>
    <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;1st principal component&quot;</span><span class="p">,</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;2nd principal component&quot;</span><span class="p">,</span>
    <span class="n">hue_label</span> <span class="o">=</span> <span class="s2">&quot;iris features&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The model can be customized by passing a mode as argument for further customization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.transform</span> <span class="kn">import</span> <span class="n">TransformWrapper</span>
<span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">TransformWrapper</span><span class="p">(</span><span class="n">base_model</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">perplexity</span><span class="o">=</span><span class="mf">30.0</span><span class="p">))</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X_reduced</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;PCA reduction of iris data set to 2 dimensions&quot;</span><span class="p">,</span>
    <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;1st principal component&quot;</span><span class="p">,</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;2nd principal component&quot;</span><span class="p">,</span>
    <span class="n">hue_label</span> <span class="o">=</span> <span class="s2">&quot;iris features&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluating-models">
<h3>Evaluating models<a class="headerlink" href="#evaluating-models" title="Link to this heading"></a></h3>
<p>The evaluation module <code class="docutils literal notranslate"><span class="pre">DimRed.evaluation</span></code> provides two main dimensionality reduction evalution methods in the class <code class="docutils literal notranslate"><span class="pre">DimRed.evaluation.ModelEvaluator</span></code>. The methods are <code class="docutils literal notranslate"><span class="pre">DimRed.evaluation.ModelEvaluator.grid_search_dr_performance</span></code> and <code class="docutils literal notranslate"><span class="pre">DimRed.evaluation.ModelEvaluator.cross_validation</span></code>.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cross_validation</span></code> wraps around <code class="docutils literal notranslate"><span class="pre">sklearn.model_selection.GridSearchCV</span></code>. In cross validation, an estimator is trained on validation data and predictions are made on test data. This would be achieved via a call to <code class="docutils literal notranslate"><span class="pre">fit()</span></code> and then <code class="docutils literal notranslate"><span class="pre">transform()</span></code> on different data sets. Some DR methods like <code class="docutils literal notranslate"><span class="pre">trimap.TRIMAP</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold.TSNE</span></code> do not support transforming non-training data. Consequently, standard cross validation cannot be used, and hence the <code class="docutils literal notranslate"><span class="pre">grid_search_dr_performance</span></code> is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_search_dr_performance</span></code> is a work-around solution for DR methods that only implement a <code class="docutils literal notranslate"><span class="pre">fit_transform()</span></code> method, which fits the model on a dataset and returns the transformed data. Models that only have this method are generally unable to transform other data points that were not part of the original train data. This method fits a DR model on the training data and transforms the training data. It then fits a new DR model on the validation data and transforms the validation data. Finally and estimator is used to obtain a performance value. For classification an sklearn pipeline with a Standard Scaler and 1-Nearest Neighbour classifier is used by default and for regression a 1-NN regressor can be used for example.</p></li>
</ol>
<p>We start off by showing an example to display the use of <code class="docutils literal notranslate"><span class="pre">grid_search_dr_performance</span></code> with trimap.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display_heatmap_df</span>
<span class="kn">from</span> <span class="nn">DimRed.evaluation</span> <span class="kn">import</span> <span class="n">ModelEvaluator</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TRIMAP&quot;</span><span class="p">],</span> <span class="s2">&quot;n_nbrs&quot;</span> <span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;n_outliers&quot;</span> <span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)}]</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;OneNN&quot;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="mi">1</span><span class="p">))])</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">model_eval</span> <span class="o">=</span> <span class="n">ModelEvaluator</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
    <span class="n">estimator</span> <span class="o">=</span> <span class="n">estimator</span><span class="p">,</span>
    <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span>
    <span class="n">n_repeats</span><span class="o">=</span><span class="n">n_repeats</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">best_score</span><span class="p">,</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model_eval</span><span class="o">.</span><span class="n">grid_search_dr_performance</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The best accuracy is </span><span class="si">{</span><span class="n">best_score</span><span class="si">}</span><span class="s2"> with the following parameters </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">display_heatmap_df</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> 
    <span class="s2">&quot;n_nbrs&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;n_outliers&quot;</span><span class="p">,</span>
    <span class="s2">&quot;score&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Accuracy of 1-NN as a function of number of inliers and outliers in TRIMAP with d=2. K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2"> cross validation with </span><span class="si">{</span><span class="n">n_repeats</span><span class="si">}</span><span class="s2"> repetitions&quot;</span>
    <span class="p">)</span>

<span class="n">display_heatmap_df</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span>
    <span class="s2">&quot;n_nbrs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_outliers&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variance&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Variance of 1-NN as a function of number of inliers and outliers in TRIMAP with d=2. K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2"> cross validation with </span><span class="si">{</span><span class="n">n_repeats</span><span class="si">}</span><span class="s2"> repetitions&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>In this example we instantiate a <code class="docutils literal notranslate"><span class="pre">ModelEvaluator</span></code> object to then call <code class="docutils literal notranslate"><span class="pre">grid_search_dr_performance</span></code>. The data sets and parameters are passed during instantiation. The estimator parameter is explicitly passed as an argument, even if it is the default value, to highlight its importance. The estimator’s purpose is to what defines the performance of a DR model. After the train and validation data has been transformed, it is trained on the train transformed data via <code class="docutils literal notranslate"><span class="pre">fit()</span></code>and evaluated on the transformed validation data via <code class="docutils literal notranslate"><span class="pre">score()</span></code>. It is convenient to use an <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code> as it easily allows chaining (e.g scaling) of the data.</p>
<p>In comparison to what <code class="docutils literal notranslate"><span class="pre">cross_validation</span></code> returns, the <code class="docutils literal notranslate"><span class="pre">results</span></code> variable contains less data as in <code class="docutils literal notranslate"><span class="pre">cross_validation</span></code> the result of <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html"><code class="docutils literal notranslate"><span class="pre">sklearn.model_selection.GridSearchCV</span></code></a> is returned.</p>
<p>The method will create parameter combinations accoring to sklearn’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ParameterGrid.html">ParameterGrid</a> class. In short, a sort of ‘cross product’ is taken between all parameter values in a dictionary, and when different dictionaries are in a list a union of parameters is computed. Note that n_jobs refers to the number of jobs in <a class="reference external" href="https://www.google.com/search?client=firefox-b-d&amp;amp;q=python+joblib">joblib</a>.</p>
<p>We now look at an example of cross validation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display_heatmap_df</span>
<span class="kn">from</span> <span class="nn">DimRed.evaluation</span> <span class="kn">import</span> <span class="n">ModelEvaluator</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PACMAP&quot;</span><span class="p">]}</span> <span class="p">,</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TSNE&quot;</span><span class="p">,</span> <span class="s2">&quot;UMAP&quot;</span><span class="p">,</span> <span class="s2">&quot;PACMAP&quot;</span><span class="p">],</span> <span class="s2">&quot;n_nbrs&quot;</span> <span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">}]</span>

<span class="n">model_eval</span> <span class="o">=</span> <span class="n">ModelEvaluator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">K</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">bestScore</span><span class="p">,</span> <span class="n">bestParams</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model_eval</span><span class="o">.</span><span class="n">cross_validation</span><span class="p">()</span>

<span class="n">display_heatmap_df</span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="s1">&#39;param_Transform__method&#39;</span><span class="p">,</span><span class="s1">&#39;param_Transform__n_nbrs&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_test_score&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Link to this heading"></a></h3>
<p>Plotting is built over the seaborn library. Methods in the module <code class="docutils literal notranslate"><span class="pre">DimRed.plot</span></code> have the goal to present transformed data or model evaluation results. The methods and the resulting plots are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">display</span></code> Plot a 2-D dataset on a seaborn relplot.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_group</span></code> Plot a grid-like arrangement of sub-plots. Can be used to qualitatively compare effectivenes of DR methods, or vary a parameter and see the effect of it visually.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_heatmap</span></code> Plot a heatmap given a square $N \times N$ <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_heatmap_df</span></code> Plot a heatmap given a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> where every row corresponds to parameters value pairs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_accuracies</span></code> Plot accuracies and method name on a bar graph with color scale proportional to accuracy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_training_validation</span></code> Line plot of accuracy vs. a common variable parameter for multiple methods.</p></li>
</ul>
<p>The most flexible method for qualitative comparisons of reduced data is <code class="docutils literal notranslate"><span class="pre">display_group</span></code>. It can be used in three main different ways:</p>
<ol class="arabic simple">
<li><p>To simply plot transformed data from the same source data set with heterogeneous models as below.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.utils.dr_utils</span> <span class="kn">import</span> <span class="n">reduce_data_with_params</span>
<span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display_group</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TSNE&quot;</span><span class="p">,</span> <span class="s2">&quot;UMAP&quot;</span><span class="p">,</span> <span class="s2">&quot;TRIMAP&quot;</span><span class="p">]</span> <span class="p">,</span> <span class="s2">&quot;n_nbrs&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">80</span><span class="p">]}</span> <span class="p">,</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PACMAP&quot;</span><span class="p">]}]</span>

<span class="n">Xs_train_reduced</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">reduce_data_with_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>

<span class="n">display_group</span><span class="p">(</span>
    <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
    <span class="n">X_train_list</span><span class="o">=</span><span class="n">Xs_train_reduced</span><span class="p">,</span>
    <span class="n">y_train</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">nbr_cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">nbr_rows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Transformed data via different DR models on the MNIST data set&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>To plot transformed data with different model parameters in a grid like fashion.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.utils.dr_utils</span> <span class="kn">import</span> <span class="n">reduce_data_with_params</span>
<span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display_group</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">range1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">range2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TRIMAP&quot;</span><span class="p">],</span> <span class="s2">&quot;n_nbrs&quot;</span> <span class="p">:</span> <span class="n">range1</span><span class="p">,</span> <span class="s2">&quot;n_outliers&quot;</span> <span class="p">:</span> <span class="n">range2</span><span class="p">}]</span>

<span class="n">Xreds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reduce_data_with_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>

<span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;n_nbrs&quot;</span><span class="p">])</span>
<span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;n_outliers&quot;</span><span class="p">])</span>

<span class="n">display_group</span><span class="p">(</span>
    <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">X_train_list</span><span class="o">=</span><span class="n">Xreds</span><span class="p">,</span>
    <span class="n">y_train</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">nbr_cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
    <span class="n">nbr_rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
    <span class="n">marker_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">grid_x_label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;n_inliers=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range1</span><span class="p">],</span>
    <span class="n">grid_y_label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;n_outliers=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range2</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;TRIMAP with variation in number of inliers and number of outliers&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>To plot training and test data on the same subplots to compare transformations.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">DimRed.utils.dr_utils</span> <span class="kn">import</span> <span class="n">reduce_data_with_params</span>
<span class="kn">from</span> <span class="nn">DimRed.plot</span> <span class="kn">import</span> <span class="n">display_group</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">range1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">range2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;method&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TRIMAP&quot;</span><span class="p">],</span> <span class="s2">&quot;n_nbrs&quot;</span> <span class="p">:</span> <span class="n">range1</span><span class="p">,</span> <span class="s2">&quot;n_outliers&quot;</span> <span class="p">:</span> <span class="n">range2</span><span class="p">}]</span>

<span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;n_nbrs&quot;</span><span class="p">])</span>
<span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;n_outliers&quot;</span><span class="p">])</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>


<span class="n">XtrainReds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span>  <span class="n">reduce_data_with_params</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>

<span class="n">XtestReds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span>  <span class="n">reduce_data_with_params</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>

<span class="n">display_group</span><span class="p">(</span>
    <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">X_train_list</span><span class="o">=</span><span class="n">XtrainReds</span><span class="p">,</span>
    <span class="n">y_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
    <span class="n">X_test_list</span><span class="o">=</span><span class="n">XtestReds</span><span class="p">,</span>
    <span class="n">y_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span>
    <span class="n">nbr_cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
    <span class="n">nbr_rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
    <span class="n">marker_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">grid_x_label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;n_inliers=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range1</span><span class="p">],</span>
    <span class="n">grid_y_label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;n_outliers=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range2</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;TRIMAP train and test projections with variation in number of inliers and number of outliers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="utilities">
<h3>Utilities<a class="headerlink" href="#utilities" title="Link to this heading"></a></h3>
<p>The two utility modules are <code class="docutils literal notranslate"><span class="pre">DimRed.utils.data</span></code> and <code class="docutils literal notranslate"><span class="pre">DimRed.utils.dr_utils</span></code>. The first module has purpose to load csv files to <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> /  <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> while the latter concerns itself with batch processing.</p>
<p>The main method in <code class="docutils literal notranslate"><span class="pre">dr_utils</span></code>is <code class="docutils literal notranslate"><span class="pre">reduce_data_with_params</span></code> which given a dictionary with parameter value pairs transforms a given data set according to all passed methods.</p>
</section>
</section>
<section id="for-developpers">
<h2>For developpers<a class="headerlink" href="#for-developpers" title="Link to this heading"></a></h2>
<p>To run the unit tests clone the repo make sure that pytest is installed. Then run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="nb">test</span>
pytest<span class="w"> </span>test_*.py
</pre></div>
</div>
<section id="contributing">
<h3>Contributing<a class="headerlink" href="#contributing" title="Link to this heading"></a></h3>
<p>To contribute please <a class="reference external" href="https://docs.github.com/en/get-started/exploring-projects-on-github/contributing-to-a-project">fork, clone, and submit a pull request</a>!</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="DimRed" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="DimRed" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Stanislas Castellana.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>